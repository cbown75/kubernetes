---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: default
  namespace: metallb-system
spec:
  # IP range for your 10.10.7.x subnet
  # Reserve .200-.250 for LoadBalancer IPs
  # This keeps them separate from your node IPs (.2-.8)
  addresses:
    - 10.10.7.200-10.10.7.250

  # Auto-assign IPs to services requesting LoadBalancer
  autoAssign: true

  # Avoid conflicts with specific IPs if needed
  avoidBuggyIPs: true
---
# Optional: Separate pool for internal services
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: internal
  namespace: metallb-system
spec:
  addresses:
    - 10.10.7.100-10.10.7.150

  # Require explicit pool selection via annotation
  autoAssign: false

  # Target specific services
  serviceSelector:
    matchLabels:
      metallb-pool: internal
---
apiVersion: metallb.io/v1beta1
kind: L2Advertisement
metadata:
  name: default
  namespace: metallb-system
spec:
  ipAddressPools:
    - default
    - internal

  # Optional: Advertise from specific nodes only
  # Uncomment to limit which nodes can be leaders
  # nodeSelectors:
  #   - matchLabels:
  #       node-role.kubernetes.io/worker: "true"

  # Optional: Advertise on specific interfaces
  # interfaces:
  #   - eth0
  #   - ens160
