---
apiVersion: v1
kind: Namespace
metadata:
  name: storage-test
  labels:
    name: storage-test
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-holocron-fast
  namespace: storage-test
  labels:
    test: storage-validation
    nas: holocron
    tier: fast
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: nfs-holocron-fast
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-holocron-general
  namespace: storage-test
  labels:
    test: storage-validation
    nas: holocron
    tier: general
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: nfs-holocron
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-sith-fast
  namespace: storage-test
  labels:
    test: storage-validation
    nas: sith
    tier: fast
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: nfs-sith-fast
---
apiVersion: v1
kind: Pod
metadata:
  name: holocron-test-pod
  namespace: storage-test
  labels:
    test: storage-validation
spec:
  containers:
    - name: test-container
      image: busybox:1.35
      command:
        - /bin/sh
        - -c
        - |
          echo "Testing Holocron NFS storage..."
          echo "Mount point: /data"
          df -h /data
          echo "Writing test file..."
          echo "Holocron test at $(date)" > /data/holocron-test.txt
          echo "File written successfully!"
          cat /data/holocron-test.txt
          echo "Disk usage:"
          df -h /data
          echo "Test completed. Keeping pod alive for inspection..."
          sleep 3600
      volumeMounts:
        - name: holocron-storage
          mountPath: /data
  volumes:
    - name: holocron-storage
      persistentVolumeClaim:
        claimName: test-holocron-fast
  restartPolicy: Never
---
apiVersion: v1
kind: Pod
metadata:
  name: sith-test-pod
  namespace: storage-test
  labels:
    test: storage-validation
spec:
  containers:
    - name: test-container
      image: busybox:1.35
      command:
        - /bin/sh
        - -c
        - |
          echo "Testing Sith NFS storage..."
          echo "Mount point: /data"
          df -h /data
          echo "Writing test file..."
          echo "Sith test at $(date)" > /data/sith-test.txt
          echo "File written successfully!"
          cat /data/sith-test.txt
          echo "Disk usage:"
          df -h /data
          echo "Test completed. Ready for future arr stack deployment!"
          sleep 3600
      volumeMounts:
        - name: sith-storage
          mountPath: /data
  volumes:
    - name: sith-storage
      persistentVolumeClaim:
        claimName: test-sith-fast
  restartPolicy: Never
