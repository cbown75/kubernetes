{{/* Validate replica configuration */}}
{{- include "nebula-sync-pihole1.validateReplicas" . }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "nebula-sync-pihole1.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "nebula-sync-pihole1.labels" . | nindent 4 }}
data:
  # Primary PiHole URL (password will be injected via environment variable)
  primary-url: {{ .Values.nebulaSync.primary.url | quote }}
  
  # Replica PiHole URLs (passwords will be injected via environment variables)
  {{- range $index, $url := .Values.nebulaSync.replicas.urls }}
  replica-url-{{ $index }}: {{ $url | quote }}
  {{- end }}
