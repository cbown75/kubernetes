# NFS CSI Driver Configuration
nfsServers:
  holocron:
    host: "holocron.home.cwbtech.net"
    shares:
      fast: "/volume1/k8s-fast"
      general: "/volume1/k8s-general"
      backup: "/volume1/k8s-backup"
  sith:
    host: "sith.home.cwbtech.net"
    shares:
      fast: "/volume1/k8s-fast"
      general: "/volume1/k8s-general"
      backup: "/volume1/k8s-backup"

# CSI Driver Configuration - Updated for socket connection fix
image:
  nfs:
    repository: registry.k8s.io/sig-storage/nfsplugin
    tag: v4.11.0
    pullPolicy: IfNotPresent

  csiProvisioner:
    repository: registry.k8s.io/sig-storage/csi-provisioner
    tag: v5.3.0
    pullPolicy: IfNotPresent

  csiSnapshotter:
    repository: registry.k8s.io/sig-storage/csi-snapshotter
    tag: v8.3.0
    pullPolicy: IfNotPresent

  csiResizer:
    repository: registry.k8s.io/sig-storage/csi-resizer
    tag: v1.14.0
    pullPolicy: IfNotPresent

  livenessProbe:
    repository: registry.k8s.io/sig-storage/livenessprobe
    tag: v2.16.0
    pullPolicy: IfNotPresent

  nodeDriverRegistrar:
    repository: registry.k8s.io/sig-storage/csi-node-driver-registrar
    tag: v2.13.0
    pullPolicy: IfNotPresent

# Kubelet directory path
kubeletDir: /var/lib/kubelet

# Service Account Names
serviceAccount:
  controller: csi-nfs-controller-sa
  node: csi-nfs-node-sa

# Feature gates
feature:
  enableFSGroupPolicy: true
  enableInlineVolume: false

# Linux node selector
linux:
  enabled: true

# Controller configuration - Increased resources for stability
controller:
  replicas: 1
  logLevel: 2
  resources:
    csiProvisioner:
      limits:
        memory: 512Mi
        cpu: 200m
      requests:
        cpu: 50m
        memory: 128Mi
    csiSnapshotter:
      limits:
        memory: 256Mi
        cpu: 100m
      requests:
        cpu: 25m
        memory: 64Mi
    csiResizer:
      limits:
        memory: 512Mi
        cpu: 200m
      requests:
        cpu: 50m
        memory: 128Mi
    livenessProbe:
      limits:
        memory: 128Mi
        cpu: 50m
      requests:
        cpu: 10m
        memory: 32Mi
    nfs:
      limits:
        memory: 256Mi
        cpu: 200m
      requests:
        cpu: 50m
        memory: 64Mi

# Node configuration - Increased resources for stability
node:
  logLevel: 2
  resources:
    livenessProbe:
      limits:
        memory: 128Mi
        cpu: 50m
      requests:
        cpu: 10m
        memory: 32Mi
    nodeDriverRegistrar:
      limits:
        memory: 128Mi
        cpu: 50m
      requests:
        cpu: 10m
        memory: 32Mi
    nfs:
      limits:
        memory: 256Mi
        cpu: 200m
      requests:
        cpu: 50m
        memory: 64Mi

# Storage Classes - Updated configuration
storageClasses:
  # Holocron NFS Storage Classes
  holocronFast:
    enabled: true
    name: nfs-holocron-fast
    server: holocron
    share: fast
    reclaimPolicy: Delete
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    mountOptions:
      - hard
      - nfsvers=4.1
      - intr
      - timeo=600
      - retrans=2
    annotations: {}
    labels:
      nas: holocron
      tier: fast

  holocronGeneral:
    enabled: true
    name: nfs-holocron-general
    server: holocron
    share: general
    reclaimPolicy: Retain
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    mountOptions:
      - hard
      - nfsvers=4.1
      - intr
      - timeo=600
      - retrans=2
    annotations: {}
    labels:
      nas: holocron
      tier: general

  holocronBackup:
    enabled: true
    name: nfs-holocron-backup
    server: holocron
    share: backup
    reclaimPolicy: Retain
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    mountOptions:
      - hard
      - nfsvers=4.1
      - intr
      - timeo=600
      - retrans=2
    annotations: {}
    labels:
      nas: holocron
      tier: backup

  # Sith NFS Storage Classes
  sithFast:
    enabled: true
    name: nfs-sith-fast
    server: sith
    share: fast
    reclaimPolicy: Delete
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    mountOptions:
      - hard
      - nfsvers=4.1
      - intr
      - timeo=600
      - retrans=2
    annotations: {}
    labels:
      nas: sith
      tier: fast

  sithGeneral:
    enabled: true
    name: nfs-sith-general
    server: sith
    share: general
    reclaimPolicy: Retain
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    mountOptions:
      - hard
      - nfsvers=4.1
      - intr
      - timeo=600
      - retrans=2
    annotations: {}
    labels:
      nas: sith
      tier: general

  sithBackup:
    enabled: true
    name: nfs-sith-backup
    server: sith
    share: backup
    reclaimPolicy: Retain
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    mountOptions:
      - hard
      - nfsvers=4.1
      - intr
      - timeo=600
      - retrans=2
    annotations: {}
    labels:
      nas: sith
      tier: backup
